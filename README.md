# Serge√Ø Malwares detector

Detect potentially malicious PHP files.
Based on <https://github.com/jvoisin/php-malware-finder> by jvoisin for the regex rules. Thanks to him.
Added suspicious namings in string and variable tokens.

## Version

1.0.beta

## Requirements

PHP 5.3 >=

## Usage

```mw [directory] [-R] [-i] [-lw [whitelistName]]```

- -R : Recursive
- -i : ignore. Don't ask user prompt
- -lw : Learn and whitelist.

## Examples

```mw ../WordPress/ -R```

Scan the directory ```../Wordpress``` recursively and ask an user action if a broken rule is detected.

```mw ../WordPress/ -R -i```

Scan the directory ```../Wordpress``` recursively but ignore prompt. It's an overall seeing.

```mw ../phpmyadmin/ -R -lw "phpmyadmin 4.1"```

Scan the ```../phpmyadmin/``` directory considered safe and whitelist the files breaking the standard rules in the "phpmyadmin 4.1" whitelist. See "whitelisted.json".

## Files

### freq.json

Contains all the trigrams learned in safe files and whitelisted variable/string names.

### rules.json

Contains all the malware signature and rules.

### whitelisted.json

Contains all the *sha* computed for whitelisted files.

## Todo

Whitelist some PHP frameworks :

- Laravel
- Zend
- Drupal
- Symfony
- etc...

Send email for CRON process
Error managing with ```throw``
etc.
