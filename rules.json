{
  "isPhp" : {
    "global": true,
    "strings" : {
      "php" : "/<\\?[^x]/"
    },
    "condition" : [
      "php", 
      "$and", 
      ["#filesize", "<", "5MB"]
    ]
  },
  "NonPrintableChars" :
  {
    "strings": {
      "non_printables" : "/(function|return|base64_decode).{,256}[^\\x09-\\x0d\\x20-\\x7E]{3}/"
    },
    "condition": ["any of them"]
  },
  "PasswordProtection" :
  {
    "strings": {
        "md5" : "/md5\\s*\\(\\s*\\$_(GET|REQUEST|POST|COOKIE|SERVER)[^)]+\\)\\s*===?\\s*['\"][0-9a-f]{32}['\"]/i",
        "sha1" : "/sha1\\s*\\(\\s*\\$_(GET|REQUEST|POST|COOKIE|SERVER)[^)]+\\)\\s*===?\\s*['\"][0-9a-f]{40}['\"]/i"
    },
    "condition": ["any of them"]
  },
  "ObfuscatedPhp" :
  {
    "strings": {
      "eval" : "/(<\\?php|[;{}])[ \\t]*@?(eval|preg_replace|system|assert|passthru|(pcntl_)?exec|shell_exec|call_user_func(_array)?)\\s*\\(/i",
      "eval_comment" : "/(eval|preg_replace|system|assert|passthru|(pcntl_)?exec|shell_exec|call_user_func(_array)?)\\/\\*[^\\*]*\\*\\/\\(/i",
      "b374k" : "'ev'.'al'",
      "align" : "/(\\$\\w+=[^;]*)*;\\$\\w+=@?\\$\\w+\\(/",
      "weevely3" : "/\\$\\w=\\$[a-zA-Z]\\('',\\$\\w\\);\\$\\w\\(\\);/",
      "c99_launcher" : "/;\\$\\w+\\(\\$\\w+(,\\s?\\$\\w+)+\\);/",
      "nano" : "/\\$[a-z0-9-_]+\\[[^]]+\\]\\(/",
      "ninja" : "/base64_decode[^;]+getallheaders/",
      "variable_variable" :  "/\\${\\$[0-9a-zA-z]+}/",
      "too_many_chr" : "/(chr\\([\\d]+\\)\\.){8}/",
      "concat" : "/(\\$[^\\n\\r]+\\.){5}/",
      "concat_with_spaces" : "/(\\$[^\\n\\r]+\\. ){5}/",
      "var_as_func" : "/\\$_(GET|POST|COOKIE|REQUEST|SERVER)\\s*\\[[^\\]]+\\]\\s*\\(/",
      "comment" : "/\\/\\*([^*]|\\*[^\\/])*\\*\\/\\s*\\(/"
    },
    "condition": ["any of them"]
  },
  "DodgyPhp" : 
  {
    "strings" : {
      "basedir_bypass" : "/curl_init\\s*\\(\\s*[\"']file:\\/\\//i",
      "basedir_bypass2" : "file:file:///",
      "disable_magic_quotes" : "/set_magic_quotes_runtime\\s*\\(\\s*0/i",
      "execution" : "/\\b(eval|assert|passthru|exec|include|system|pcntl_exec|shell_exec|base64_decode|`|array_map|ob_start|call_user_func(_array)?)\\s*\\(\\s*(base64_decode|php:\\/\\/input|str_rot13|gz(inflate|uncompress)|getenv|pack|\\\\?\\$_(GET|REQUEST|POST|COOKIE|SERVER))/i",
      "execution2" : "/\\b(array_filter|array_reduce|array_walk(_recursive)?|array_walk|assert_options|uasort|uksort|usort|preg_replace_callback|iterator_apply)\\s*\\(\\s*[^,]+,\\s*(base64_decode|php:\\/\\/input|str_rot13|gz(inflate|uncompress)|getenv|pack|\\\\?\\$_(GET|REQUEST|POST|COOKIE|SERVER))/i",
      "execution3" : "/\\b(array_(diff|intersect)_u(key|assoc)|array_udiff)\\s*\\(\\s*([^,]+\\s*,?)+\\s*(base64_decode|php:\\/\\/input|str_rot13|gz(inflate|uncompress)|getenv|pack|\\\\?\\$_(GET|REQUEST|POST|COOKIE|SERVER))\\s*\\[[^]]+\\]\\s*\\)+\\s*;/i",
      "htaccess" : "SetHandler application/x-httpd-php",
      "iis_com" : "/IIS:\\/\\/localhost\\/w3svc/",
      "include" : "/include\\s*\\(\\s*[^\\.]+\\.(png|jpg|gif|bmp)/",
      "ini_get" : "/ini_(get|set|restore)\\s*\\(\\s*['\"](safe_mode|open_basedir|disable_(function|classe)s|safe_mode_exec_dir|safe_mode_include_dir|register_globals|allow_url_include)/i",
      "pr" : "/(preg_replace(_callback)?|mb_ereg_replace|preg_filter)\\s*\\(.+(\\/|\\\\x2f)(e|\\\\x65)['\"]/i",
      "register_function" : "/register_[a-z]+_function\\s*\\(\\s*['\"]\\s*(eval|assert|passthru|exec|include|system|shell_exec|`)/",
      "safemode_bypass" : "/\\x00\\/\\.\\.\\/|LD_PRELOAD/",
      "shellshock" : "/\\(\\)\\s*{\\s*[a-z:]\\s*;\\s*}\\s*;/",
      "udp_dos" : "/fsockopen\\s*\\(\\s*['\"]udp:\\/\\//i",
      "various" : "\"<!--#exec cmd=\"",
      "at_eval" : "/@eval\\s*\\(/i",
      "double_var" : "/\\${\\s*\\${/",
      "extract" : "/extract\\s*\\(\\s*\\$_(GET|POST|REQUEST|COOKIE|SERVER)/",
      "reversed" : "/noitcnuf_etaerc|metsys|urhtssap|edulcni|etucexe_llehs/i",
      "silenced_include" : "/@\\s*include\\s*/i"
    },
    "condition": ["any of them"]
  },
  "DangerousPhp" :
  {
    "strings" : {
      "system" : "/\\bsystem\\b/i",
      "array_filter" : "/\\barray_filter\\b/i",
      "assert" : "/\\bassert\\b/i",
      "backticks" : "/\\bbackticks\\b/i",
      "call_user_func" : "/\\bcall_user_func\\b/i",
      "eval" : "/\\beval\\b/i",
      "exec" : "/\\bexec\\b/i",
      "fpassthru" : "/\\bfpassthru\\b/i",
      "fsockopen" : "/\\bfsockopen\\b/i",
      "function_exists" : "/\\bfunction_exists\\b/i",
      "getmygid" : "/\\bgetmygid\\b/i",
      "shmop_open" : "/\\bshmop_open\\b/i",
      "mb_ereg_replace_callback" : "/\\bmb_ereg_replace_callback\\b/i",
      "passthru" : "/\\bpassthru\\b/i",
      "pcntl" :  "/\\bpcntl_(exec|fork)\\b/i",
      "php_uname" : "/\\bphp_uname\\b/i",
      "phpinfo" : "/\\bphpinfo\\b/i",
      "posix_geteuid" : "/\\bposix_geteuid\\b/i",
      "posix_getgid" : "/\\bposix_getgid\\b/i",
      "posix_getpgid" : "/\\bposix_getpgid\\b/i",
      "posix_getppid" : "/\\bposix_getppid\\b/i",
      "posix_getpwnam" : "/\\bposix_getpwnam\\b/i",
      "posix_getpwuid" : "/\\bposix_getpwuid\\b/i",
      "posix_getsid" : "/\\bposix_getsid\\b/i",
      "posix_getuid" : "/\\bposix_getuid\\b/i",
      "posix_kill" : "/\\bposix_kill\\b/i",
      "posix_setegid" : "/\\bposix_setegid\\b/i",
      "posix_seteuid" : "/\\bposix_seteuid\\b/i",
      "posix_setgid" : "/\\bposix_setgid\\b/i",
      "posix_setpgid" : "/\\bposix_setpgid\\b/i",
      "posix_setsid" : "/\\bposix_setsid\\b/i",
      "posix_setuid" : "/\\bposix_setuid\\b/i",
      "preg_replace_callback" : "/\\bpreg_replace_callback\\b/i",
      "proc_open" : "/\\bproc_open\\b/i",
      "proc_close" : "/\\bproc_close\\b/i",
      "popen" : "/\\bpopen\\b/i",
      "register_shutdown_function" : "/\\bregister_shutdown_function\\b/i",
      "register_tick_function" : "/\\bregister_tick_function\\b/i",
      "shell_exec" : "/\\bshell_exec\\b/i",
      "shm_open" : "/\\bshm_open\\b/i",
      "show_source" : "/\\bshow_source\\b/i",
      "socket_create(AF_INET, SOCK_STREAM, SOL_TCP)" : "/\\bsocket_create(AF_INET, SOCK_STREAM, SOL_TCP)\\b/i",
      "stream_socket_pair" : "/\\bstream_socket_pair\\b/i",
      "suhosin.executor.func.blacklist" : "/\\bsuhosin.executor.func.blacklist\\b/i",
      "unregister_tick_function" : "/\\bunregister_tick_function\\b/i",
      "win32_create_service" : "/\\bwin32_create_service\\b/i",
      "xmlrpc_decode" : "/\\bxmlrpc_decode\\b/i",
      "ob_start" : "/ob_start\\s*\\(\\s*[^\\)]/" 
    },
    "condition" : ["5 of them"]
  },
  "HiddenInAFile" : {
    "strings": {
      "gif": "^\\x47\\x49\\x46\\x38.\\x61",
      "png": "^\\x89\\x50\\x4E\\x47\\x0D\\x0A\\x1A\\x0a",
      "jpeg": "^\\xFF\\xD8\\xFF\\xE0..\\x4A\\x46\\x49\\x46"
    },
    "condition" : [
      "any of them",
      "$and",
      [
        "PasswordProtection",
        "$or",
        "ObfuscatedPhp",
        "$or",
        "DodgyPhp",
        "$or",
        "DangerousPhp"
      ]
    ]
  },
  "CloudFlareBypass" : {
    "strings": {
      "chk_jschl" : "chk_jschl",
      "jschl_vc" : "jschl_vc",
      "jschl_answer" : "jschl_answer"
    },
    "condition": ["2 of them"]
  },
  "IRC" : 
  {
    "private" : true,
    "strings" : {
      "USER" : "/\\bUSER\\b/",
      "PASS" : "/\\bPASS\\b/",
      "PRIVMSG" : "/\\bPRIVMSG\\b/",
      "MODE" : "/\\bMODE\\b/",
      "PING" : "/\\bPING\\b/",
      "PONG" : "/\\bPONG\\b/",
      "JOIN" : "/\\bJOIN\\b/",
      "PART" : "/\\bPART\\b/"
    },
    "condition" : ["5 of them"]
  },
  "b64" :
  {
    "private" : true,
    "strings" : {
        "user_agent" : "SFRUUF9VU0VSX0FHRU5UCg",
        "eval" : "ZXZhbCg",
        "system" : "c3lzdGVt",
        "preg_replace" : "cHJlZ19yZXBsYWNl",
        "exec" : "ZXhlYyg",
        "base64_decode" : "YmFzZTY0X2RlY29kZ",
        "perl_shebang" : "IyEvdXNyL2Jpbi9wZXJsCg",
        "cmd_exe" : "Y21kLmV4ZQ",
        "powershell" : "cG93ZXJzaGVsbC5leGU"
    },
    "condition": ["any of them"]
  },
  "hex" :
  {
    "private" : true,
    "strings": {
      "globals" : "/\\\\x47\\\\x4c\\\\x4f\\\\x42\\\\x41\\\\x4c\\\\x53/i",
      "eval" : "/\\\\x65\\\\x76\\\\x61\\\\x6C\\\\x28/i",
      "exec" : "/\\\\x65\\\\x78\\\\x65\\\\x63/i",
      "system" : "/\\\\x73\\\\x79\\\\x73\\\\x74\\\\x65\\\\x6d/i",
      "preg_replace" : "/\\\\x70\\\\x72\\\\x65\\\\x67\\\\x5f\\\\x72\\\\x65\\\\x70\\\\x6c\\\\x61\\\\x63\\\\x65/i",
      "http_user_agent" : "/\\\\x48\\\\124\\\\x54\\\\120\\\\x5f\\\\125\\\\x53\\\\105\\\\x52\\\\137\\\\x41\\\\107\\\\x45\\\\116\\\\x54/i",
      "base64_decode" : "/\\\\x61\\\\x73\\\\x65\\\\x36\\\\x34\\\\x5f\\\\x64\\\\x65\\\\x63\\\\x6f\\\\x64\\\\x65\\\\x28\\\\x67\\\\x7a\\\\x69\\\\x6e\\\\x66\\\\x6c\\\\x61\\\\x74\\\\x65\\\\x28/i"
    },
    "condition": ["any of them"]
  },
  "Hpack" :
  {
    "private" : true,
    "strings": {
      "globals" : "/474c4f42414c53/i",
      "eval" : "/6576616C28/i",
      "exec" : "/65786563/i",
      "system" : "/73797374656d/i",
      "preg_replace" : "/707265675f7265706c616365/i",
      "base64_decode" : "/61736536345f6465636f646528677a696e666c61746528/i"
    },
    "condition": [ "any of them" ]
  },
  "strrev" :
  {
    "private" : true,
    "strings": {
      "globals" : "/\\bslabolg\\b/i",
      "preg_replace" : "/\\becalper_gerp\\b/i",
      "base64_decode" : "/\\bedoced_46esab\\b/i",
      "gzinflate" : "/\\betalfnizg\\b/i"
    },
    "condition" : ["any of them"]
  },
  "SuspiciousEncoding" :
  {
    "condition": ["b64", "$or", "hex", "$or", "strrev", "$or", "Hpack"]
  },
  "DodgyStrings" :
  {
    "strings" : {
      ".bash_history" : ".bash_history",
      "addType" : "/AddType\\s+application\/x-httpd-(php|cgi)/i",
      "php_value" : "/php_value\\s*auto_prepend_file/i",
      "secFilter" : "/SecFilterEngine\\s+Off/i",
      "addHandler" : "/Add(Handler|Type|OutputFilter)\\s+[^\\s]+\\s+\\.htaccess/i",
      ".mysql_history" : ".mysql_history",
      ".ssh/authorized_keys" : ".ssh/authorized_keys",
      "/(.*)/e" : "/(.*)/e",  
      "/../../../" : "/../../../",
      "/etc/passwd" : "/etc/passwd",
      "/etc/proftpd.conf" : "/etc/proftpd.conf",
      "/etc/resolv.conf" : "/etc/resolv.conf",
      "/etc/shadow" : "/etc/shadow",
      "/etc/syslog.conf" : "/etc/syslog.conf",
      "/proc/cpuinfo" : "/\\b/proc/cpuinfo\\b/",
      "/var/log/lastlog" : "/var/log/lastlog",
      "/windows/system32/" : "/windows/system32/",
      "LOAD DATA LOCAL INFILE" : "/LOAD DATA LOCAL INFILE/i",
      "WScript.Shell" : "WScript.Shell",
      "WinExec" : "WinExec",
      "b374k" : "/\\bb374k\\b/i",
      "backdoor" : "/\\bbackdoor\\b/i",
      "c99shell" : "/(c99|r57|fx29)shell/",
      "cmd.exe" : "/\\bcmd.exe\\b/i",
      "powershell.exe" : "/\\bpowershell.exe\\b/i",
      "defac" : "/\\bdefac(ed|er|ement|ing)\\b/i",
      "evilc0ders" : "/\\bevilc0ders\\b/i",
      "exploit" : "/\\bexploit\\b/i",
      "find . -type f" : "/\\bfind . -type f\\b/",
      "hashcrack" : "/hashcrack/i",
      "id_rsa" : "/\\bid_rsa\\b/", 
      "ipconfig" : "/\\bipconfig\\b/i",
      "kernel32.dll" : "/\\bkernel32.dll\\b/i",
      "kingdefacer" : "/kingdefacer/i",
      "Wireghoul" : "/\\bWireghoul\\b/i",
      "LD_PRELOAD" : "/\\bLD_PRELOAD\\b/",
      "libpcprofile" : "libpcprofile",  
      "locus7s" : "/locus7s/i",
      "ls -la" : "/\\bls -la\\b/",
      "meterpreter" : "/\\bmeterpreter\\b/",
      "nc -l" : "/\\bnc -l\\b/",
      "netstat -an" : "/\\bnetstat -an\\b/",
      "php" : "php://",
      "ps -aux" : "/\\bps -aux\\b/",
      "rootkit" : "/\\brootkit\\b/i",
      "slowloris" : "/\\bslowloris\\b/i",
      "suhosin" : "/\\bsuhosin\\b/",
      "sun-tzu" : "/\\bsun-tzu\\b/i", 
      "trojan" : "/trojan (payload)?/",
      "uname -a" : "/\\buname -a\\b/",
      "visbot" : "/\\bvisbot\\b/i", 
      "warez" : "/\\bwarez\\b/i",
      "whoami" : "/\\bwhoami\\b/",
      "reverseCmd" : "/(r[e3]v[e3]rs[e3]|w[3e]b|cmd)\\s*sh[e3]ll/i",
      "perm" : "/-perm -0[24]000/",
      "binbash" : "/\\b\\/bin\\/(ba)?sh\\b/",
      "hack" : "/hack(ing|er|ed)/",
      "safeopen" : "/(safe_mode|open_basedir) bypass/i",
      "exec" : "/xp_(execresultset|regenumkeys|cmdshell|filelist)/",
      "vbs" : "/language\\s*=\\s*vbscript/",
      "asp" : "/scripting.filesystemobject/i"
    }
    ,
    "condition": ["IRC", "$or", "2 of them"]
  },
  "websites" : {
    "strings" : {
      "1337day.com" : "/1337day.com/i",
      "antichat.ru" : "/antichat.ru/i",
      "b374k" : "/b374k/i",
      "ccteam.ru" : "/ccteam.ru/i",
      "crackfor" : "/crackfor/i",
      "darkc0de" : "/darkc0de/i",
      "egyspider.eu" : "/egyspider.eu/i",
      "exploit-db.com" : "/exploit-db.com/i",
      "fopo.com.ar" : "/fopo.com.ar/i", 
      "hashchecker.com" : "/hashchecker.com/i",
      "hashkiller.com" : "/hashkiller.com/i",
      "md5crack.com" : "/md5crack.com/i",
      "md5decrypter.com" : "/md5decrypter.com/i",
      "milw0rm.com" : "/milw0rm.com/i",
      "milw00rm.com" : "/milw00rm.com/i",
      "packetstormsecurity" : "/packetstormsecurity/i",
      "pentestmonkey.net" : "/pentestmonkey.net/i",
      "phpjiami.com" : "/phpjiami.com/i",
      "rapid7.com" : "/rapid7.com/i",
      "securityfocus" : "/securityfocus/i",
      "shodan.io" : "/shodan.io/i",
      "github.com/b374k/b374k" : "/github.com/b374k/b374k/i",
      "mumaasp.com" : "/mumaasp.com/i"
    },
    "condition" : ["any of them"]
  }
}